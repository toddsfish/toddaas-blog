<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>EC2 Autoscaling Warm Pools are very useful for looooooooong bootstrap times - Part 1 | toddaas blog</title><meta name=keywords content="aws,automation,ec2 autoscaling,ec2,autoscaling,lambda function,eventbridge,serverless,lambda"><meta name=description content="So whats the scenario? I came up against some a customer requirement of minimising the impact of long application bootstrap times in an autoscaling group partnered along side the requirement of keeping their standard barebones EC2 AMI interchangable. Essentially the customer did not want to have to deal with the bloat or overheads of maintaining a specific prebaked application AMI alongside an image building solution like EC2 Image Builder or a third party solution like Hashicorp Packer."><meta name=author content="Todd"><link rel=canonical href=https://blog.toddaas.com/posts/ec2_warm_pools_are_useful/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.toddaas.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://blog.toddaas.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://blog.toddaas.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://blog.toddaas.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://blog.toddaas.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="EC2 Autoscaling Warm Pools are very useful for looooooooong bootstrap times - Part 1"><meta property="og:description" content="So whats the scenario? I came up against some a customer requirement of minimising the impact of long application bootstrap times in an autoscaling group partnered along side the requirement of keeping their standard barebones EC2 AMI interchangable. Essentially the customer did not want to have to deal with the bloat or overheads of maintaining a specific prebaked application AMI alongside an image building solution like EC2 Image Builder or a third party solution like Hashicorp Packer."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.toddaas.com/posts/ec2_warm_pools_are_useful/"><meta property="og:image" content="https://blog.toddaas.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-08T05:10:21+10:00"><meta property="article:modified_time" content="2023-08-08T05:10:21+10:00"><meta property="og:site_name" content="toddaas"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.toddaas.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="EC2 Autoscaling Warm Pools are very useful for looooooooong bootstrap times - Part 1"><meta name=twitter:description content="So whats the scenario? I came up against some a customer requirement of minimising the impact of long application bootstrap times in an autoscaling group partnered along side the requirement of keeping their standard barebones EC2 AMI interchangable. Essentially the customer did not want to have to deal with the bloat or overheads of maintaining a specific prebaked application AMI alongside an image building solution like EC2 Image Builder or a third party solution like Hashicorp Packer."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.toddaas.com/posts/"},{"@type":"ListItem","position":2,"name":"EC2 Autoscaling Warm Pools are very useful for looooooooong bootstrap times - Part 1","item":"https://blog.toddaas.com/posts/ec2_warm_pools_are_useful/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"EC2 Autoscaling Warm Pools are very useful for looooooooong bootstrap times - Part 1","name":"EC2 Autoscaling Warm Pools are very useful for looooooooong bootstrap times - Part 1","description":"So whats the scenario? I came up against some a customer requirement of minimising the impact of long application bootstrap times in an autoscaling group partnered along side the requirement of keeping their standard barebones EC2 AMI interchangable. Essentially the customer did not want to have to deal with the bloat or overheads of maintaining a specific prebaked application AMI alongside an image building solution like EC2 Image Builder or a third party solution like Hashicorp Packer.","keywords":["aws","automation","ec2 autoscaling","ec2","autoscaling","lambda function","eventbridge","serverless","lambda"],"articleBody":"So whats the scenario? I came up against some a customer requirement of minimising the impact of long application bootstrap times in an autoscaling group partnered along side the requirement of keeping their standard barebones EC2 AMI interchangable. Essentially the customer did not want to have to deal with the bloat or overheads of maintaining a specific prebaked application AMI alongside an image building solution like EC2 Image Builder or a third party solution like Hashicorp Packer. Enter EC2 Autoscaling Warm Pools…\nWhat are EC2 Autoscaling Warm Pools? https://aws.amazon.com/blogs/compute/scaling-your-applications-faster-with-ec2-auto-scaling-warm-pools/\nWhy would you use Autoscaling Warm Pools? Warm pools are super useful when you have an application that has a significant amount of bootstrapping time usually attibuted to bespoke application configuration requirements applied on instance launch into an Autoscaling Group.\nHow do Autoscaling Group Lifecycle Hooks work when using Warm Pools So I learnt there is abit of a gotcha or side affect by design of Warm Pools, when it comes to using them alongside existing Lifecycle hooks to do bootstrapping of an application on EC2 instance launch.\nLet take a couple of example scenarios:\nScenario 1 - A Standard Autocaling group with Lifecycle Hook applied on EC2_INSTANCE_LAUNCHING: In a standard autoscaling group with a Lifecycle Hook applied on EC2_INSTANCE_LAUNCHING scale out. The instance first moves into Pending:Wait state, whereby it will remain in the Pending:Wait state whilst you bootstrap or configure your instance using automation usually in the form of UserData scripts or SSM automations. As such the final step in your automation following the instance bootstrap will be to call the complete-lifecycle-action API to continue or complete the lifecycle action. The autoscaling group then continues moving the instance into InService within the autoscaling group ready to serve client requests.\nScenario 2 - An Autoscaling group with an existing Lifecycle Hook applied on EC2_INSTANCE_LAUNCHING and a Autoscaling Group Warm Pool The solution you guessed it, more automation! Other useful references: Warm Pools https://docs.aws.amazon.com/autoscaling/ec2/userguide/ec2-auto-scaling-warm-pools.html\nEC2 Autoscaling Lifecycle Hooks https://docs.aws.amazon.com/autoscaling/ec2/userguide/lifecycle-hooks-overview.html\nLifecycle Hooks with Warm Pools https://docs.aws.amazon.com/autoscaling/ec2/userguide/warm-pool-instance-lifecycle.html\n","wordCount":"334","inLanguage":"en","datePublished":"2023-08-08T05:10:21+10:00","dateModified":"2023-08-08T05:10:21+10:00","author":{"@type":"Person","name":"Todd"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.toddaas.com/posts/ec2_warm_pools_are_useful/"},"publisher":{"@type":"Organization","name":"toddaas blog","logo":{"@type":"ImageObject","url":"https://blog.toddaas.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://blog.toddaas.com/ accesskey=h title="  (Alt + H)"></a><div class=logo-switches></div></div><ul id=menu><li><a href=https://blog.toddaas.com/ title=home><span>home</span></a></li><li><a href=https://blog.toddaas.com/posts/ title=posts><span>posts</span></a></li><li><a href=https://blog.toddaas.com/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>EC2 Autoscaling Warm Pools are very useful for looooooooong bootstrap times - Part 1</h1><div class=post-meta><span title='2023-08-08 05:10:21 +1000 AEST'>August 8, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Todd</div></header><div class=post-content><h2 id=so-whats-the-scenario>So whats the scenario?<a hidden class=anchor aria-hidden=true href=#so-whats-the-scenario>#</a></h2><p>I came up against some a customer requirement of minimising the impact of long application bootstrap times in an autoscaling group partnered along side the requirement of keeping their standard barebones EC2 AMI interchangable. Essentially the customer did not want to have to deal with the bloat or overheads of maintaining a specific prebaked application AMI alongside an image building solution like EC2 Image Builder or a third party solution like Hashicorp Packer. Enter EC2 Autoscaling Warm Pools&mldr;</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/Q6TLWqn82J4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h3 id=what-are-ec2-autoscaling-warm-pools>What are EC2 Autoscaling Warm Pools?<a hidden class=anchor aria-hidden=true href=#what-are-ec2-autoscaling-warm-pools>#</a></h3><p><a href=https://aws.amazon.com/blogs/compute/scaling-your-applications-faster-with-ec2-auto-scaling-warm-pools/>https://aws.amazon.com/blogs/compute/scaling-your-applications-faster-with-ec2-auto-scaling-warm-pools/</a></p><h3 id=why-would-you-use-autoscaling-warm-pools>Why would you use Autoscaling Warm Pools?<a hidden class=anchor aria-hidden=true href=#why-would-you-use-autoscaling-warm-pools>#</a></h3><p>Warm pools are super useful when you have an application that has a significant amount of bootstrapping time usually attibuted to bespoke application configuration requirements applied on instance launch into an Autoscaling Group.</p><h3 id=how-do-autoscaling-group-lifecycle-hooks-work-when-using-warm-pools>How do Autoscaling Group Lifecycle Hooks work when using Warm Pools<a hidden class=anchor aria-hidden=true href=#how-do-autoscaling-group-lifecycle-hooks-work-when-using-warm-pools>#</a></h3><p>So I learnt there is abit of a gotcha or side affect by design of Warm Pools, when it comes to using them alongside existing Lifecycle hooks to do bootstrapping of an application on EC2 instance launch.</p><p>Let take a couple of example scenarios:</p><h4 id=scenario-1---a-standard-autocaling-group-with-lifecycle-hook-applied-on-ec2_instance_launching>Scenario 1 - A Standard Autocaling group with Lifecycle Hook applied on EC2_INSTANCE_LAUNCHING:<a hidden class=anchor aria-hidden=true href=#scenario-1---a-standard-autocaling-group-with-lifecycle-hook-applied-on-ec2_instance_launching>#</a></h4><p>In a standard autoscaling group with a Lifecycle Hook applied on EC2_INSTANCE_LAUNCHING scale out. The instance first moves into Pending:Wait state, whereby it will remain in the Pending:Wait state whilst you bootstrap or configure your instance using automation usually in the form of UserData scripts or SSM automations. As such the final step in your automation following the instance bootstrap will be to call the complete-lifecycle-action API to continue or complete the lifecycle action. The autoscaling group then continues moving the instance into InService within the autoscaling group ready to serve client requests.</p><p><img loading=lazy src=/img/lifecycle_hooks.png alt="Standard Lifecycle Hooks" title="Standard Lifecycle Hooks"></p><h4 id=scenario-2---an-autoscaling-group-with-an-existing-lifecycle-hook-applied-on-ec2_instance_launching-and-a-autoscaling-group-warm-pool>Scenario 2 - An Autoscaling group with an existing Lifecycle Hook applied on EC2_INSTANCE_LAUNCHING and a Autoscaling Group Warm Pool<a hidden class=anchor aria-hidden=true href=#scenario-2---an-autoscaling-group-with-an-existing-lifecycle-hook-applied-on-ec2_instance_launching-and-a-autoscaling-group-warm-pool>#</a></h4><p><img loading=lazy src=/img/warm-pools-lifecycle-hooks.png alt="Lifecycle Hooks with Warm Pools" title="Lifecycle Hooks with Warm Pools"></p><h3 id=the-solution-you-guessed-it-more-automation>The solution you guessed it, more automation!<a hidden class=anchor aria-hidden=true href=#the-solution-you-guessed-it-more-automation>#</a></h3><h3 id=other-useful-references>Other useful references:<a hidden class=anchor aria-hidden=true href=#other-useful-references>#</a></h3><p>Warm Pools
<a href=https://docs.aws.amazon.com/autoscaling/ec2/userguide/ec2-auto-scaling-warm-pools.html>https://docs.aws.amazon.com/autoscaling/ec2/userguide/ec2-auto-scaling-warm-pools.html</a></p><p>EC2 Autoscaling Lifecycle Hooks
<a href=https://docs.aws.amazon.com/autoscaling/ec2/userguide/lifecycle-hooks-overview.html>https://docs.aws.amazon.com/autoscaling/ec2/userguide/lifecycle-hooks-overview.html</a></p><p>Lifecycle Hooks with Warm Pools
<a href=https://docs.aws.amazon.com/autoscaling/ec2/userguide/warm-pool-instance-lifecycle.html>https://docs.aws.amazon.com/autoscaling/ec2/userguide/warm-pool-instance-lifecycle.html</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.toddaas.com/tags/aws/>aws</a></li><li><a href=https://blog.toddaas.com/tags/automation/>automation</a></li><li><a href=https://blog.toddaas.com/tags/ec2-autoscaling/>ec2 autoscaling</a></li><li><a href=https://blog.toddaas.com/tags/ec2/>ec2</a></li><li><a href=https://blog.toddaas.com/tags/autoscaling/>autoscaling</a></li><li><a href=https://blog.toddaas.com/tags/lambda-function/>lambda function</a></li><li><a href=https://blog.toddaas.com/tags/eventbridge/>eventbridge</a></li><li><a href=https://blog.toddaas.com/tags/serverless/>serverless</a></li><li><a href=https://blog.toddaas.com/tags/lambda/>lambda</a></li></ul><nav class=paginav><a class=next href=https://blog.toddaas.com/posts/leaning_towards_dev_ops/><span class=title>Next »</span><br><span>Leaning towards dev(ops)</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><footer class=footer><span>&copy; 2023 <a href=https://blog.toddaas.com/>toddaas blog</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>